<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     base_default
 * @copyright   Copyright (c) 2012 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>
<?php
/**
 * Top menu for store
 *
 * @see Mage_Catalog_Block_Navigation
 */
?>
<?php
/**
 * $this->renderCategoriesMenuHtml() supports optional arguments:
 * int Level number for list item class to start from
 * string Extra class of outermost list items
 * string If specified wraps children list in div with this class
 */
?><?php $_menu = $this->renderCategoriesMenuHtml(0,'level-top') ?>
<?php if($_menu): ?>
<div class="block block-menu-navleft">
    <div class="block-title">
        <strong><span><?php echo $this->__('Category') ?></span></strong>
    </div>
    <div class="block-content">
		<ul id="nav1" class="menu-left">
        <?php echo $_menu ?>
		</ul>
    </div>
</div>
<?php endif ?>
<script type="text/javascript"> 
	var lis=$$('#nav1 li.parent');
	lis.each(function(li) {

	 var dt = new Element('dt');
	 var dd = new Element('dd');
	 var a = li.down(0);
	 var ul = li.down(2);
	 dt.insert(a);
	 dd.insert(ul);
	 li.insert(dt,{position:top});
	 li.insert(dd);
	});
	 jQuery('#nav1 li.parent dd ul ').hide();
	  jQuery('#nav1 dt a').click(function()  {
		
        jQuery('.td_active').removeClass('td_active');
        var node = jQuery(this).parent().next().find('ul').first();
        
        var i = (node.css('display')=="block");
      
		var string = jQuery(this).parent().parent().parent().parent().parent().attr('class');
		if(string.indexOf('parent')!=-1)
		{
			jQuery(this).parent().parent().parent().parent().parent().addClass('td_active');
			jQuery(this).parent().parent().parent().css("display","block");
			jQuery(this).parent().parent().find('ul').slideUp('slow');
		}
		else
		{
			jQuery('#nav1 li.parent dd ul:visible').slideUp('slow');
		}
        jQuery(this).parent().parent().addClass('td_active');    
        if (i != true) 	
        {
        	jQuery(this).parent().next().find('ul').first().slideDown('slow');
        	
        }	
		//if(jQuery(this).parent().parent().find('ul').css('display')=='block')
		//{
		//	  jQuery(this).parent().parent().removeClass('td_active');
		//}
		//jQuery(this).parent().parent().children().children(':first-child').css("display","block");
        return false;
    });
	
	
</script> 
